<!DOCTYPE html>
<html><head><title>DL8</title>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
<meta name="viewport" content="width=1024">
<LINK REL="stylesheet" TYPE="text/css" HREF="common.css">
<script type="text/javascript" src="button_enable.js"></script>
<script type="text/javascript" src="dl_header.js"></script>
<script type="text/javascript" src="data_do.js"></script>
<script type="text/javascript" src="button_event.js"></script>
<script type="text/javascript" src="xml_cmd.js" ></script>
<script type="text/javascript">
new Image().src = "004_ON.JPG";
new Image().src = "005_ON.JPG";
new Image().src = "006_ON.JPG";
new Image().src = "007_ON.JPG";
new Image().src = "008_ON.JPG";
new Image().src = "010_ON.JPG";
new Image().src = "011_ON.JPG";
new Image().src = "012_ON.JPG";
new Image().src = "013_ON.JPG";
new Image().src = "015_ON.JPG";
new Image().src = "016_ON.JPG";

var print_mode = 0;
var auto_updating = 0;

window.onresize = function() {
	var table,hh;
	table = document.getElementById( "area_do" );
	if( window.innerHeight ){
		hh = window.innerHeight - 241 - 20;
	}
	else if( document.documentElement.clientHeight ){
		hh = document.documentElement.clientHeight - 241 - 20;
	} else{
		return;
	}
	table.setAttribute( "style", "height :" + hh + "px" );
}

window.onload = function() {
	var table,hh,ch;
	var row,cell,txt;
	var str;

	if( button_disable != 0 ){
		document.getElementById("sel").title = "";
	}

	update_header();

	table = document.getElementById( "area_do" );
	hh = window.innerHeight - 241 - 20;
	table.setAttribute( "style", "height :" + hh + "px" );

	table = document.getElementById( "list_do" );
	for( ch=0; ch<do_chs; ch++ ) {
	    row = table.insertRow( ch );
		if( ch & 1 )	row.setAttribute( "style", "background-color: #5a5a5a" );
		else			row.setAttribute( "style", "background-color: #808080" );

		row.setAttribute( "height", "24px" );

        cell = row.insertCell(0);
        cell.setAttribute( "class", "ch" );
		str = do_ch[ch];
		txt = document.createTextNode( str );
		cell.appendChild(txt);

        cell = row.insertCell(1);
        cell.setAttribute( "class", "name" );
		str = do_name[ch];
		txt = document.createTextNode( str );
		cell.appendChild(txt);

        cell = row.insertCell(2);
        cell.setAttribute( "class", "tagno" );
		str = do_comm[ch];
		txt = document.createTextNode( str );
		cell.appendChild(txt);

        cell = row.insertCell(3);
        cell.setAttribute( "class", "status" );
		txt = document.createTextNode( do_data[ch] );
		cell.appendChild(txt);

        cell = row.insertCell(4);
        cell.setAttribute( "class", "signal" );
        cell.setAttribute( "style", "background-color: " + do_color[ch] );

        cell = row.insertCell(5);
        cell.setAttribute( "class", "blank" );
		txt = document.createTextNode( "" );
		cell.appendChild(txt);

        cell = row.insertCell(6);
        cell.setAttribute( "class", "on" );
		btn = document.createElement("input");
		btn.setAttribute( "type", "button" );
		btn.setAttribute( "class", "on_button" );
		str = do_string_on[ch];
		btn.setAttribute( "value", str );
		str = "OutputDO(" + do_chno[ch] + ",'ON','" + do_name[ch] + "','" + do_string_on[ch] +  "');";
		btn.setAttribute( "onclick", str );
		if( (button_disable == 1) || (do_enable[ch] == 0) ) btn.disabled = true;
		cell.appendChild(btn);

        cell = row.insertCell(7);
        cell.setAttribute( "class", "off" );
		btn = document.createElement("input");
		btn.setAttribute( "type", "button" );
		btn.setAttribute( "class", "off_button" );
		str = do_string_off[ch];
		btn.setAttribute( "value", str );
		str = "OutputDO(" + do_chno[ch] + ",'OFF','" + do_name[ch] + "','" + do_string_off[ch] +  "');";
		btn.setAttribute( "onclick", str );
		if( (button_disable == 1) || (do_enable[ch] == 0) ) btn.disabled = true;
		cell.appendChild(btn);
	}

	var pos = getCookie( "POS_DO" );
	if( pos ){
		if( pos != 0 ){
			document.getElementById("area_do").scrollTop = pos;
			clearCookie( "POS_DO" );
		}
	}

	if( button_disable == 0 ){
		var ref = getCookie("REF_DO");
		if( ref == "" ){
			ref = "0";
		}
		if( ref != 0 ){
			setInterval("update_refresh()",ref*1000);
		}
	}

}

function update_refresh()
{
	if( print_mode != 0 ) return;
	if( auto_updating != 0 ) return;
	auto_updating = 1;
	update_data_do( update_auto, update_timeout );
}

function update_timeout()
{
	auto_updating = 0;
}

function update_auto()
{
	var ch,table;
	update_header_time();
	table = document.getElementById( "list_do" );
	for( ch=0; ch<do_chs; ch++ ) {
//		table.rows[ch].cells[0].innerHTML = do_ch[ch];
//		table.rows[ch].cells[1].innerHTML = do_name[ch];
//		table.rows[ch].cells[2].innerHTML = do_comm[ch];
		table.rows[ch].cells[3].innerHTML = do_data[ch];
		table.rows[ch].cells[4].setAttribute( "style", "background-color: " + do_color[ch] );
	}
	auto_updating = 0;
}

function update_local()
{
	file_load_ie( "./data_do.html" );
	file_load_ie( "./data_do.js" );
	var pos = document.getElementById("area_do").scrollTop;
	if( pos != 0 ){
		setCookie( "POS_DO", pos );
	}
	update();
}

function data_do_print()
{
	if( print_mode == 0 ){
		print_mode = 1;
		document.getElementById("area_do").scrollTop = 0;
		document.getElementById("area_do").className = "area_do_print";
		alert("print mode");
	} else{
		print_mode = 0;
		document.getElementById("area_do").className = "area_do";
		window.onresize();
		alert("normal mode");
	}
}

function refresh_rate()
{
	if( button_disable != 0 ) return;

	var ref = getCookie("REF_DO");
	if( ref == "" ){
		ref = "0";
	}
	var rtn = window.prompt( "auto refresh rate 0-999[s]", ref );
	if( rtn != null ){
		if( rtn.match(/[^0-9]/) ){
			alert("input error");
			return;
		}

		var num = Number(rtn);
		if( (num < 0) || (num > 999) ){
			alert("input error");
			return;
		}

		setCookieX( "REF_DO", rtn );
		update_local();
	}
}
</script>
<style type="text/css">
.table_header{
	position : absolute;
	top: 241px;
	left: 0px;
	width : 1024px;
	height : 20px;
	border-spacing: 0;
	table-layout: fixed;
	word-break: break-all;
	word-wrap: break-word;
}
.area_do{
	position : absolute;
	top: 261px;
	left: 0px;
	width : 1024px;
	border-spacing: 0;
	overflow-x: hidden;
	overflow-y: auto;
	-webkit-overflow-scrolling: touch;
}
.area_do_print{
	position : absolute;
	top: 261px;
	left: 0px;
	width : 1024px;
	border-spacing: 0;
	overflow-x: visible;
	overflow-y: visible;
	-webkit-overflow-scrolling: touch;
}
.area_do > *{
	-webkit-transform: translateZ(0px);
}
.table_do{
	width : 1024px;
	border-spacing: 0;
	table-layout: fixed;
	word-break: break-all;
	word-wrap: break-word;
	padding: 1px;
}
.ch_header{
	width : 5%;
	font-family:"ＭＳ ゴシック";
	font-size : middle;
	color : #ffffff;
	text-align : center;
	vertical-align : middle;
	border-style: solid;
	border-color: black;
	border-width: 1px 1px 1px 0px;
}
.ch{
	width : 5%;
	font-family:"ＭＳ ゴシック";
	font-size : middle;
	color : #ffffff;
	text-align : center;
	vertical-align : middle;
	border-style: solid;
	border-color: black;
	border-width: 1px 1px 1px 0px;
}
.name_header{
	width : 20%;
	font-family:"ＭＳ ゴシック";
	font-size : middle;
	color : #ffffff;
	text-align : center;
	vertical-align : middle;
	border-style: solid;
	border-color: black;
	border-width: 1px;
}
.name{
	width : 20%;
	font-family:"ＭＳ ゴシック";
	font-size : middle;
	color : #ffffff;
	text-align : left;
	vertical-align : middle;
	border-style: solid;
	border-color: black;
	border-width: 1px;
}
.tagno_header{
	width : 20%;
	font-family:"ＭＳ ゴシック";
	font-size : middle;
	color : #ffffff;
	text-align : center;
	vertical-align : middle;
	border-style: solid;
	border-color: black;
	border-width: 1px;
}
.tagno{
	width : 20%;
	font-family:"ＭＳ ゴシック";
	font-size : middle;
	color : #ffffff;
	text-align : left;
	vertical-align : middle;
	border-style: solid;
	border-color: black;
	border-width: 1px;
}
.status_header{
	width : 15%;
	font-family:"ＭＳ ゴシック";
	font-size : middle;
	color : #ffffff;
	text-align : center;
	vertical-align : middle;
	border-style: solid;
	border-color: black;
	border-width: 1px;
}
.status{
	width : 15%;
	font-family:"ＭＳ ゴシック";
	font-size : middle;
	color : #ffffff;
	text-align : center;
	vertical-align : middle;
	border-style: solid;
	border-color: black;
	border-width: 1px;
}
.signal_header{
	width : 10%;
	font-family:"ＭＳ ゴシック";
	font-size : middle;
	color : #ffffff;
	text-align : center;
	vertical-align : middle;
	border-style: solid;
	border-color: black;
	border-width: 1px 0px 1px 1px;
}
.signal{
	width : 10%;
	font-family:"ＭＳ ゴシック";
	font-size : middle;
	color : #ffffff;
	text-align : left;
	vertical-align : middle;
	border-style: solid;
	border-color: black;
	border-width: 1px 0px 1px 1px;
}
.blank_header{
	width : 10%;
	font-family:"ＭＳ ゴシック";
	font-size : middle;
	color : #ffffff;
	text-align : center;
	vertical-align : middle;
	border-style: solid;
	border-color: black;
	border-width: 1px;
}
.blank{
	width : 10%;
	font-family:"ＭＳ ゴシック";
	font-size : middle;
	color : #ffffff;
	text-align : right;
	vertical-align : middle;
	border-style: solid;
	border-color: black;
	border-width: 1px;
}
.on_header{
	width : 10%;
	font-family:"ＭＳ ゴシック";
	font-size : middle;
	color : #ffffff;
	text-align : center;
	vertical-align : middle;
	border-style: solid;
	border-color: black;
	border-width: 1px;
}
.on{
	width : 10%;
	font-family:"ＭＳ ゴシック";
	font-size : middle;
	color : #ffffff;
	text-align : center;
	vertical-align : middle;
	border-style: solid;
	border-color: black;
	border-width: 1px;
}
.on_button{
	width: 98px;
/*	height: 18px;	*/
	padding: 1px;
	font-family:"ＭＳ ゴシック";
	font-size : small;

	white-space: nowrap;
	overflow: hidden;
	text-overflow: ellipsis;
}
.off_header{
	width : 10%;
	font-family:"ＭＳ ゴシック";
	font-size : middle;
	color : #ffffff;
	text-align : center;
	vertical-align : middle;
	border-style: solid;
	border-color: black;
	border-width: 1px;
}
.off{
	width : 10%;
	font-family:"ＭＳ ゴシック";
	font-size : middle;
	color : #ffffff;
	text-align : center;
	vertical-align : middle;
	border-style: solid;
	border-color: black;
	border-width: 1px;
}
.off_button{
	width: 98px;
/*	height: 18px;	*/
	padding: 1px;
	font-family:"ＭＳ ゴシック";
	font-size : small;

	white-space: nowrap;
	overflow: hidden;
	text-overflow: ellipsis;
}
</style>
</head>

<body style="background-color: #000000;">

<!-- HEADER -->
<div>
	<table class="header">
	  <tbody><tr>
    	<td class="name1" id="name1"></td>
    	<td class="name2" id="name2"></td>
    	<td class="fig1"></td>
      </tr></tbody>
    </table>
</div>

<!-- MENU -->
<div>
	<!-- Menu -->
	<input class ="menu" type="button" onclick="disp_menu();">

	<!-- Data -->
	<input class ="data_sel" type="button" title="normal mode <-> print mode" onclick="data_do_print();">

	<!-- Trend -->
	<input class ="trend" type="button" onclick="disp_trend();">

	<!-- Event -->
	<input class ="event" type="button" onclick="disp_event();">

	<!-- Update -->
	<input class ="update" type="button" onclick="update_local();">
</div>

<!-- FUNCTION -->
<div>
	<!-- background -->
	<div class="back_left"></div>

	<!-- AI_DATA -->
	<input class ="ai_data" type="button" onclick="data_ai();">

	<!-- DI_DATA -->
	<input class ="di_data" type="button" onclick="data_di();">

	<!-- PI_DATA -->
	<input class ="pi_data" type="button" onclick="data_pi();">

	<!-- DO_DATA -->
<!--
	<div class="do_data_sel"></div>
-->
	<input class="do_data_sel" id="sel" type="button" title="auto refresh" onclick="refresh_rate();">

	<!-- AO DATA -->
	<input class ="ao_data" type="button" onclick="data_ao();">

	<!-- PREV -->
	<input class ="prev" type="button" onclick="data_pi();">

	<!-- NEXT -->
	<input class ="next" type="button" onclick="data_ao();">

	<!-- background -->
	<div class="back_right"></div>
</div>

<!-- TIME,NAME3,DATE -->
<div>
	<table class="time_name3_date">
	  <tbody><tr>
    	<td class="back18"></td>
    	<td class="time" id="time"></td>
    	<td class="name3" id="name3"></td>
    	<td class="date" id="date"></td>
    	<td class="back22"></td>
      </tr></tbody>
    </table>
</div>

<!-- DO DATA -->
<div>
	<table class="table_header">
	  <tbody>
	  <tr style="background-color: #5a5a5a;">
	    <th class="ch_header">Ch</th>
	    <th class="name_header">Name</th>
	    <th class="tagno_header">Comment</th>
	    <th class="status_header">Status</th>
	    <th class="signal_header">Signal</th>
	    <th class="blank_header"></th>
	    <th class="on_header">ON</th>
	    <th class="off_header">OFF</th>
	  </tr>
	  </tbody>
	</table>
</div>
<div class="area_do" id="area_do">
	<table class="table_do" id="list_do">
	  <tbody></tbody>
	</table>
</div>

</body></html>

